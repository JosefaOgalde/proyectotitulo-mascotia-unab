{% extends 'registro/base.html' %}
{% load static %}

{% block title %}Registro Mascota - Mascotia.app{% endblock %}

{% block extra_css %}
<style>
    body {
        background-color: #f5f5f5 !important;
        margin: 0;
        padding: 0;
        padding-top: 50px;
    }

    .pet-container {
        display: flex;
        min-height: calc(100vh - 50px);
        max-width: 1200px;
        margin: 0 auto;
        gap: 1rem;
        padding: 0 24px;
        align-items: center;
        justify-content: center;
        background-color: #f5f5f5;
    }

    .pet-left-panel {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: flex-end;
        padding: 1.5rem 0.5rem 1.5rem 1.5rem;
    }

    .pet-image-container {
        width: 100%;
        max-width: 420px;
        height: calc(100vh - 50px);
        min-height: 500px;
        background-color: #2d8a94;
        border-radius: 1.25rem;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        padding: 1.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
    }

    .pet-image-container img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 1rem;
    }

    .pet-right-panel {
        flex: 1;
        display: flex;
        align-items: flex-start;
        justify-content: flex-start;
        padding: 1.5rem 1.5rem 1.5rem 0.5rem;
        background-color: #f5f5f5;
        overflow: hidden;
    }

    .pet-card {
        width: 100%;
        max-width: 420px;
        background-color: #ffffff;
        border-radius: 1.25rem;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
        padding: 1rem;
        height: calc(100vh - 50px);
        min-height: 500px;
        display: flex;
        flex-direction: column;
        overflow-y: auto;
        overflow-x: hidden;
    }

    .back-link {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        color: #5bb4c5;
        text-decoration: none;
        font-weight: 600;
        font-size: 0.9rem;
        margin-bottom: 1rem;
    }

    .back-link:hover {
        text-decoration: underline;
    }

    .pet-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: #000000;
        margin-bottom: 0.4rem;
        text-align: center;
    }

    .pet-info-box {
        background-color: #e8e8e8;
        border-radius: 0.75rem;
        padding: 0.85rem 1rem;
        margin-bottom: 0.85rem;
        text-align: center;
    }

    .pet-info-box p {
        margin: 0;
        color: #000000;
        font-size: 0.75rem;
    }

    .pet-info-box p:first-child {
        font-weight: 600;
        margin-bottom: 0.4rem;
    }

    .pet-info-box p:last-child {
        opacity: 0.8;
        font-size: 0.7rem;
    }

    .pet-greeting {
        color: #000000;
        opacity: 0.7;
        font-size: 0.75rem;
        margin-bottom: 1rem;
    }

    .pet-form {
        flex: 1;
        min-height: 0;
    }

    .form-section-title {
        font-size: 0.85rem;
        font-weight: 600;
        color: #000000;
        margin-bottom: 0.75rem;
    }

    .form-group {
        margin-bottom: 0.85rem;
    }

    .form-group label {
        display: block;
        font-size: 0.8rem;
        font-weight: 600;
        color: #000000;
        margin-bottom: 0.3rem;
    }

    .form-control {
        width: 100%;
        padding: 0.55rem 0.75rem;
        border: 1px solid #d1d5db;
        border-radius: 0.5rem;
        font-size: 0.85rem;
        color: #000000;
        background-color: #ffffff;
    }

    .form-control:focus {
        outline: none;
        border-color: #5bb4c5;
        box-shadow: 0 0 0 3px rgba(91, 180, 197, 0.1);
    }

    .toggle-container {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        margin-bottom: 0.75rem;
        padding: 0.75rem;
        background-color: #f5f5f5;
        border-radius: 0.5rem;
        cursor: pointer;
    }

    .toggle-container:hover {
        background-color: #eeeeee;
    }

    .toggle-container input[type="checkbox"] {
        width: 1.25rem;
        height: 1.25rem;
        cursor: pointer;
        margin: 0;
    }

    .toggle-container label {
        cursor: pointer;
        margin: 0;
        flex: 1;
        font-weight: 400;
    }

    #campos-edad-aproximada {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0.75rem;
        margin-top: 0.75rem;
    }

    .checkbox-container {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem;
        background-color: #f5f5f5;
        border-radius: 0.5rem;
    }

    .checkbox-container input[type="checkbox"] {
        width: 1.25rem;
        height: 1.25rem;
        cursor: pointer;
    }

    .checkbox-container label {
        margin: 0;
        cursor: pointer;
        font-weight: 400;
    }

    .form-error {
        color: #ed99c5;
        font-size: 0.8rem;
        margin-top: 0.25rem;
    }

    .form-help {
        font-size: 0.75rem;
        color: #000000;
        opacity: 0.6;
        margin-top: 0.25rem;
    }

    .submit-button {
        width: 100%;
        padding: 0.75rem 1.5rem;
        background-color: #5bb4c5;
        color: #ffffff;
        border: none;
        border-radius: 0.75rem;
        font-size: 0.95rem;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.2s ease;
        margin-top: 1rem;
        margin-bottom: 1rem;
    }

    .submit-button:hover {
        background-color: #4a9ba8;
    }

    .pet-note {
        font-size: 0.75rem;
        color: #000000;
        opacity: 0.7;
        margin-top: 0.4rem;
    }

    @media (max-width: 1024px) {
        .pet-container {
            flex-direction: column;
            padding: 1rem;
        }

        .pet-left-panel,
        .pet-right-panel {
            padding: 1rem;
        }

        .pet-image-container,
        .pet-card {
            min-height: 500px;
            max-width: 100%;
        }
    }

    @media (max-width: 768px) {
        .pet-navbar {
            padding: 0.75rem 1rem;
        }

        .pet-container {
            padding: 0.75rem;
        }

        .pet-card {
            padding: 1.5rem;
        }

        #campos-edad-aproximada {
            grid-template-columns: 1fr;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="pet-container">
    <!-- Panel izquierdo con imagen -->
    <div class="pet-left-panel">
        <div class="pet-image-container">
            <img src="{% static 'registro/images/completar-perfil.jpeg' %}" alt="Mascotia - Completar perfil">
        </div>
    </div>

    <!-- Panel derecho con formulario -->
    <div class="pet-right-panel">
        <div class="pet-card">
            <!-- Volver atrás -->
            <a href="{% url 'home' %}" class="back-link">
                <span>←</span>
                <span>Volver atrás</span>
            </a>

            <!-- Título -->
            <div style="text-align: center; margin-bottom: 1rem;">
                <h1 class="pet-title">Agregar una mascota</h1>
            </div>

            <!-- Banner de información de mascota -->
            <div style="background-color: #5bb4c5; border-radius: 0.75rem; padding: 1rem; margin-bottom: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                <div style="width: 40px; height: 40px; border-radius: 50%; background-color: #ffffff; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 2C8.13 2 5 5.13 5 9C5 14.25 12 22 12 22C12 22 19 14.25 19 9C19 5.13 15.87 2 12 2ZM12 11.5C10.62 11.5 9.5 10.38 9.5 9C9.5 7.62 10.62 6.5 12 6.5C13.38 6.5 14.5 7.62 14.5 9C14.5 10.38 13.38 11.5 12 11.5Z" fill="#5bb4c5"/>
                    </svg>
                </div>
                <div style="flex: 1;">
                    <p style="font-weight: 600; color: #000000; margin: 0 0 0.25rem 0; font-size: 0.9rem;">Información de tu mascota</p>
                    <p style="color: #000000; margin: 0; font-size: 0.75rem; opacity: 0.9;">Esta data nos ayudará a construir la bitácora de salud y poder visualizar toda la información de tu mascota.</p>
                </div>
            </div>

            <!-- Banner de personalización -->
            <div style="background-color: #a8e3e1; border-radius: 0.75rem; padding: 0.85rem 1rem; margin-bottom: 1rem;">
                <p style="color: #000000; margin: 0; font-size: 0.75rem; text-align: center;">Hola {{ user_name }}, ingresa los datos de tu mascota para personalizar la información de salud de tu mascota.</p>
            </div>

            <!-- Mensajes de Django como notificaciones -->
            {% if messages %}
                <div style="margin-bottom: 1rem;">
                    {% for message in messages %}
                        <div class="alert alert-{{ message.tags }}" style="padding: 0.75rem 1rem; border-radius: 0.5rem; margin-bottom: 0.5rem; {% if message.tags == 'success' %}background-color: #d2de7d; color: #000000;{% elif message.tags == 'error' %}background-color: #ed99c5; color: #000000;{% else %}background-color: #a8e3e1; color: #000000;{% endif %}">
                            {{ message }}
                        </div>
                    {% endfor %}
                </div>
            {% endif %}

            <!-- Formulario -->
            <form method="post" class="pet-form" enctype="multipart/form-data">
                {% csrf_token %}
                
                <h2 class="form-section-title">Añadir nueva mascota</h2>

                <!-- Campo Foto -->
                <div class="form-group">
                    <label for="{{ form.foto.id_for_label }}">
                        {{ form.foto.label }}
                    </label>
                    <input type="file" name="foto" id="{{ form.foto.id_for_label }}" accept="image/*" class="form-control">
                    {% if form.foto.help_text %}
                        <p class="form-help">{{ form.foto.help_text }}</p>
                    {% endif %}
                    {% if form.foto.errors %}
                        <div class="form-error">
                            {% for error in form.foto.errors %}
                                <p>{{ error }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <!-- Campos en dos columnas: Nombre y Especie -->
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:0.75rem; margin-bottom:0.85rem;">
                    <!-- Campo Nombre -->
                    <div class="form-group" style="margin-bottom:0;">
                        <label for="{{ form.nombre.id_for_label }}">
                            {{ form.nombre.label }}
                        </label>
                        {{ form.nombre }}
                        {% if form.nombre.errors %}
                            <div class="form-error">
                                {% for error in form.nombre.errors %}
                                    <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>

                    <!-- Campo Especie -->
                    <div class="form-group" style="margin-bottom:0;">
                        <label for="{{ form.especie.id_for_label }}">
                            {{ form.especie.label }}
                        </label>
                        {{ form.especie }}
                        {% if form.especie.errors %}
                            <div class="form-error">
                                {% for error in form.especie.errors %}
                                    <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Campo Raza -->
                <div class="form-group">
                    <label for="{{ form.raza.id_for_label }}">
                        {{ form.raza.label }}
                    </label>
                    {{ form.raza }}
                    {% if form.raza.errors %}
                        <div class="form-error">
                            {% for error in form.raza.errors %}
                                <p>{{ error }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <!-- Campo Fecha de nacimiento o edad aproximada -->
                <div class="form-group">
                    <label style="display:block; font-size:0.9rem; font-weight:600; color:#000000; margin-bottom:0.5rem;">Fecha de nacimiento o edad aproximada</label>
                    
                    <div class="toggle-container">
                        {{ form.usar_edad_aproximada }}
                        <label for="{{ form.usar_edad_aproximada.id_for_label }}" style="margin:0; font-size:0.9rem; color:#000000; cursor:pointer; user-select:none; flex:1;">
                            No recuerdo la fecha exacta
                        </label>
                    </div>
                    
                    <div id="campo-fecha-exacta">
                        <label for="{{ form.fecha_nacimiento.id_for_label }}" style="display:block; font-size:0.85rem; font-weight:500; color:#000000; margin-bottom:0.35rem;">Fecha de nacimiento</label>
                        {{ form.fecha_nacimiento }}
                        {% if form.fecha_nacimiento.help_text %}
                            <p class="form-help">{{ form.fecha_nacimiento.help_text }}</p>
                        {% endif %}
                        {% if form.fecha_nacimiento.errors %}
                            <div class="form-error">
                                {% for error in form.fecha_nacimiento.errors %}
                                    <p>{{ error }}</p>
                                {% endfor %}
                            </div>
                        {% endif %}
                    </div>
                    
                    <div id="campos-edad-aproximada" style="display:none;">
                        <div>
                            <label for="{{ form.edad_anios_aproximados.id_for_label }}" style="display:block; font-size:0.85rem; font-weight:500; color:#000000; margin-bottom:0.35rem;">
                                {{ form.edad_anios_aproximados.label }} <span style="color:#ed99c5;">*</span>
                            </label>
                            {{ form.edad_anios_aproximados }}
                            {% if form.edad_anios_aproximados.help_text %}
                                <p class="form-help">{{ form.edad_anios_aproximados.help_text }}</p>
                            {% endif %}
                            {% if form.edad_anios_aproximados.errors %}
                                <div class="form-error">
                                    {% for error in form.edad_anios_aproximados.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div>
                            <label for="{{ form.edad_meses_aproximados.id_for_label }}" style="display:block; font-size:0.85rem; font-weight:500; color:#000000; margin-bottom:0.35rem;">
                                {{ form.edad_meses_aproximados.label }}
                            </label>
                            {{ form.edad_meses_aproximados }}
                            {% if form.edad_meses_aproximados.help_text %}
                                <p class="form-help">{{ form.edad_meses_aproximados.help_text }}</p>
                            {% endif %}
                            {% if form.edad_meses_aproximados.errors %}
                                <div class="form-error">
                                    {% for error in form.edad_meses_aproximados.errors %}
                                        <p>{{ error }}</p>
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>

                <!-- Campo Color de pelaje -->
                <div class="form-group">
                    <label for="{{ form.color_pelaje.id_for_label }}">
                        {{ form.color_pelaje.label }}
                    </label>
                    {{ form.color_pelaje }}
                    {% if form.color_pelaje.errors %}
                        <div class="form-error">
                            {% for error in form.color_pelaje.errors %}
                                <p>{{ error }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <!-- Campo Sexo -->
                <div class="form-group">
                    <label for="{{ form.sexo.id_for_label }}">
                        {{ form.sexo.label }}
                    </label>
                    {{ form.sexo }}
                    {% if form.sexo.errors %}
                        <div class="form-error">
                            {% for error in form.sexo.errors %}
                                <p>{{ error }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <!-- Campo Esterilizado -->
                <div class="form-group">
                    <div class="checkbox-container">
                        {{ form.esterilizado }}
                        <label for="{{ form.esterilizado.id_for_label }}">
                            {{ form.esterilizado.label }}
                        </label>
                    </div>
                    <p class="form-help" style="margin-top: 0.4rem; font-size: 0.7rem; color: #666;">Si no estás seguro, deja el campo en blanco.</p>
                    {% if form.esterilizado.errors %}
                        <div class="form-error">
                            {% for error in form.esterilizado.errors %}
                                <p>{{ error }}</p>
                            {% endfor %}
                        </div>
                    {% endif %}
                </div>

                <!-- Errores generales del formulario -->
                {% if form.non_field_errors %}
                    <div class="form-error">
                        {% for error in form.non_field_errors %}
                            <p>{{ error }}</p>
                        {% endfor %}
                    </div>
                {% endif %}

                <p class="pet-note">
                    El ID de la mascota se generará automáticamente al guardar.
                </p>

                <!-- Botón de envío -->
                <button type="submit" name="guardar" class="submit-button">Guardar mascota</button>
            </form>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const checkboxId = '{{ form.usar_edad_aproximada.id_for_label }}';
    const checkboxEdadAproximada = document.getElementById(checkboxId);
    const campoFechaExacta = document.getElementById('campo-fecha-exacta');
    const camposEdadAproximada = document.getElementById('campos-edad-aproximada');
    const inputFechaNacimiento = document.getElementById('fecha_nacimiento_input');
    const inputEdadAnios = document.getElementById('edad_anios_aproximados');
    const inputEdadMeses = document.getElementById('edad_meses_aproximados');
    const toggleContainer = document.querySelector('.toggle-container');
    
    function toggleCampos() {
        if (!checkboxEdadAproximada || !campoFechaExacta || !camposEdadAproximada) {
            return;
        }
        
        if (checkboxEdadAproximada.checked) {
            campoFechaExacta.style.display = 'none';
            camposEdadAproximada.style.display = 'grid';
            if (inputFechaNacimiento) {
                inputFechaNacimiento.value = '';
                inputFechaNacimiento.removeAttribute('required');
            }
            if (inputEdadAnios) {
                inputEdadAnios.setAttribute('required', 'required');
            }
        } else {
            campoFechaExacta.style.display = 'block';
            camposEdadAproximada.style.display = 'none';
            if (inputFechaNacimiento) {
                inputFechaNacimiento.removeAttribute('required');
            }
            if (inputEdadAnios) {
                inputEdadAnios.removeAttribute('required');
                inputEdadAnios.value = '';
            }
            if (inputEdadMeses) {
                inputEdadMeses.value = '';
            }
        }
    }
    
    if (checkboxEdadAproximada) {
        checkboxEdadAproximada.addEventListener('change', toggleCampos);
        
        if (toggleContainer) {
            toggleContainer.addEventListener('click', function(e) {
                if (e.target !== checkboxEdadAproximada && e.target.tagName !== 'LABEL') {
                    checkboxEdadAproximada.click();
                }
            });
        }
        
        toggleCampos();
    }
    
    // Actualizar razas según la especie seleccionada
    const especieSelect = document.getElementById('id_especie');
    const razaSelect = document.getElementById('id_raza');
    
    if (especieSelect && razaSelect) {
        const razasPerro = [
            ['', 'Seleccionar raza'],
            ['Labrador Retriever', 'Labrador Retriever'],
            ['Golden Retriever', 'Golden Retriever'],
            ['Pastor Alemán', 'Pastor Alemán'],
            ['Bulldog Francés', 'Bulldog Francés'],
            ['Bulldog Inglés', 'Bulldog Inglés'],
            ['Beagle', 'Beagle'],
            ['Poodle', 'Poodle'],
            ['Rottweiler', 'Rottweiler'],
            ['Yorkshire Terrier', 'Yorkshire Terrier'],
            ['Boxer', 'Boxer'],
            ['Dachshund', 'Dachshund'],
            ['Siberian Husky', 'Siberian Husky'],
            ['Chihuahua', 'Chihuahua'],
            ['Border Collie', 'Border Collie'],
            ['Shih Tzu', 'Shih Tzu'],
            ['Maltés', 'Maltés'],
            ['Mestizo', 'Mestizo'],
            ['No lo sé', 'No lo sé'],
        ];
        
        const razasGato = [
            ['', 'Seleccionar raza'],
            ['Persa', 'Persa'],
            ['Maine Coon', 'Maine Coon'],
            ['British Shorthair', 'British Shorthair'],
            ['Ragdoll', 'Ragdoll'],
            ['Siamés', 'Siamés'],
            ['Bengalí', 'Bengalí'],
            ['Abisinio', 'Abisinio'],
            ['Sphynx', 'Sphynx'],
            ['Scottish Fold', 'Scottish Fold'],
            ['American Shorthair', 'American Shorthair'],
            ['Ruso Azul', 'Ruso Azul'],
            ['Noruego del Bosque', 'Noruego del Bosque'],
            ['Mestizo', 'Mestizo'],
            ['No lo sé', 'No lo sé'],
        ];
        
        function actualizarRazas() {
            const especie = especieSelect.value;
            razaSelect.innerHTML = '';
            
            let razas = [];
            if (especie === 'perro') {
                razas = razasPerro;
            } else if (especie === 'gato') {
                razas = razasGato;
            } else {
                razas = [['', 'Selecciona primero la especie']];
                razaSelect.disabled = true;
            }
            
            razas.forEach(function(raza) {
                const option = document.createElement('option');
                option.value = raza[0];
                option.textContent = raza[1];
                razaSelect.appendChild(option);
            });
            
            if (especie) {
                razaSelect.disabled = false;
            }
        }
        
        especieSelect.addEventListener('change', actualizarRazas);
        // Aplicar al cargar la página si ya hay una especie seleccionada
        if (especieSelect.value) {
            actualizarRazas();
        }
    }
});
</script>

<!-- Popup de éxito -->
{% if mostrar_popup %}
<div id="popup-mascota" style="position:fixed; top:0; left:0; right:0; bottom:0; background-color:rgba(0,0,0,0.5); display:flex; align-items:center; justify-content:center; z-index:1000; padding:1rem;">
    <div style="background-color:#ffffff; border-radius:1.5rem; padding:2.5rem; max-width:500px; width:100%; box-shadow:0 10px 40px rgba(0,0,0,0.2);">
        <div style="text-align:center; margin-bottom:2rem;">
            <div style="width:80px; height:80px; border-radius:50%; background-color:#5bb4c5; display:flex; align-items:center; justify-content:center; margin:0 auto 1rem;">
                <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z" fill="#ffffff"/>
                </svg>
            </div>
            <h2 style="font-size:1.35rem; font-weight:700; color:#000000; margin:0 0 0.5rem;">¡Has comenzado con la ficha de tu mascota!</h2>
            <p style="color:#666; margin:0; font-size:0.9rem;">{{ mascota_guardada }} ha sido agregada exitosamente a tu bitácora.</p>
        </div>
        <div style="display:flex; flex-direction:column; gap:1rem;">
            <a href="{% url 'registro_mascota' %}" style="display:inline-flex; align-items:center; justify-content:center; gap:0.5rem; padding:0.85rem 1.5rem; border-radius:9999px; background-color:#5bb4c5; color:#ffffff; border:1px solid #5bb4c5; font-weight:700; text-decoration:none; font-size:0.95rem; cursor:pointer;">
                <div style="width:20px; height:20px; border-radius:50%; background-color:#ffffff; display:flex; align-items:center; justify-content:center;">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z" fill="#5bb4c5"/>
                    </svg>
                </div>
                <span>Agregar una nueva mascota</span>
            </a>
            <a href="{% url 'home' %}" style="display:inline-flex; align-items:center; justify-content:center; gap:0.5rem; padding:0.85rem 1.5rem; border-radius:9999px; background-color:#e8e8e8; color:#000000; border:1px solid #e8e8e8; font-weight:700; text-decoration:none; font-size:0.95rem; cursor:pointer;">
                <div style="width:20px; height:20px; border-radius:50%; background-color:#5bb4c5; display:flex; align-items:center; justify-content:center;">
                    <svg width="12" height="12" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z" fill="#ffffff"/>
                    </svg>
                </div>
                <span>Ir al home</span>
            </a>
        </div>
    </div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const popup = document.getElementById('popup-mascota');
    if (popup) {
        // Cerrar popup al hacer clic fuera
        popup.addEventListener('click', function(e) {
            if (e.target === popup) {
                popup.style.display = 'none';
            }
        });
    }
});
</script>
{% endif %}

    <!-- Footer (usando el mismo footer que inicio.html) -->
    {% include 'registro/footer.html' %}
{% endblock %}
